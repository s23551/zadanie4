W trakcie tego samouczka ponownie użyjemy klas SqlConnection iSqlCommand. Tym razem logika interakcji z naszą bazą danych będzie niecobardziej skomplikowana. Tworzymy aplikację dla firmy zarządzającejmagazynem. Poniżej przedstawiono bazę danych, której używamy. Ponadto,w pliku create.sql znajdziesz skrypt, który tworzy tabele i wypełnia je danymi.Zadanie 1Utwórz WarehouseController i punkt końcowy, który będzie akceptować danew następującym formacie.Wszystkie pola są wymagane. Następnie zaimplementuj następującyscenariusz.
Główny scenariusz:Zadanie 2*Następnie dodaj drugi punkt końcowy do WarehouseController i spróbujzaimplementować tę samą logikę za pomocą procedury składowanej. W plikuproc.sql znajdziesz procedurę składowaną przygotowaną przez administratorabazy danych. Sprawdź pracę administratora bazy danych i upewnij się, żeprocedura składowana jest poprawna (może zawierać błędy). Następniewykonaj ją z twojego punktu końcowego.Pamiętaj:1. Sprawdzamy, czy produkt o podanym identyfikatorze istnieje. Następniesprawdzamy, czy magazyn o podanym identyfikatorze istnieje. Wartośćilości przekazana w żądaniu powinna być większa niż 0.2. Możemy dodać produkt do magazynu tylko wtedy, gdy istniejezamówienie zakupu produktu w tabeli Order. Dlatego sprawdzamy, czy wtabeli Order istnieje rekord z IdProduktu i Ilością (Amount), któreodpowiadają naszemu żądaniu. Data utworzenia zamówienia powinnabyć wcześniejsza niż data utworzenia w żądaniu.3. Sprawdzamy, czy to zamówienie zostało przypadkiem zrealizowane.Sprawdzamy, czy nie ma wiersza z danym IdOrder w tabeliProduct_Warehouse.4. Aktualizujemy kolumnę FullfilledAt zamówienia na aktualną datę igodzinę. (UPDATE)5. Wstawiamy rekord do tabeli Product_Warehouse. Kolumna Pricepowinna odpowiadać cenie produktu pomnożonej przez kolumnę Amountz naszego zamówienia. Ponadto wstawiamy wartość CreatedAt zgodniez aktualnym czasem. (INSERT)6. W wyniku operacji zwracamy wartość klucza głównego wygenerowanegodla rekordu wstawionego do tabeli Product_Warehouse.w przypadku jakiegokolwiek błędu zwróć odpowiedni kod HTTP.
